@model MovieListViewModel

@{
    var currentPage = ViewContext.RouteData.Values["Controller"].ToString().ToLower();
    var rnd = new Random();
    var carouselList = new List<Movie>();
    var miniList = new List<Movie>();
    for (int i = 1; i < 6; i++)
    {
        var select = rnd.Next(1, 51);
        foreach (var item in Model.Movies)
        {
            if (item.Id == select && !carouselList.Any(x => x.Id == select))
            {
                carouselList.Add(item);
            }
        }
    }
    for (int i = 1; i < 5; i++)
    {
        var select = rnd.Next(1, 51);
        foreach (var item in Model.Movies)
        {
            if (item.Id == select &&
                !carouselList.Any(x => x.Id == select) &&
                !miniList.Any(x => x.Id == select))
            {
                miniList.Add(item);
            }
        }
    }
}

<div class="container text-center">
    <div class="row">
        <div class="container">
            <div class="control-container">
                <ejs-carousel id="defaultCarousel"
                              partialVisible=true
                              pauseOnHover=true
                              dataSource="@carouselList"
                              showIndicators=false
                              itemTemplate='<figure class="img-container">
                                            <img src="${ImageUrl}"/>
                                            </figure>'>                              
                </ejs-carousel>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-4">
            <img id="details" class="thumbnail" src="https://cdn.cdon.com/cmpadmin/images/2022-10-10-13-15-59-1559-a9d91be7-fb1b-414e-907d-fda44b28bfadtopgunmaverick_cdon_1200x600.jpg?impolicy=imagebeam&imwidth=1200" />
        </div>
        <div class="col-4">
            <img class="thumbnail" src="https://cdn.cdon.com/cmpadmin/images/2022-10-10-13-15-59-1559-ae496605-79c4-46f6-b185-71b58250450ajurassicworlddominion_cdon_1200x600.jpg?impolicy=imagebeam&imwidth=1200" />
        </div>
        <div class="col-4">
            <img class="thumbnail" src="https://cdn.cdon.com/cmpadmin/images/2022-10-03-13-08-11-811-2306d96d-5866-4057-9511-87d4e668fd3aelvis_ordernow_cdon_1200x600.jpg?impolicy=imagebeam&imwidth=1200" />
        </div>
    </div>

    <div class="row">
        <div class="col-4">
            <a class="btn btn-dark thumbnail" asp-controller="cart"
               asp-action="addtocart" asp-route-id="1" asp-route-currentPage="@currentPage">Add to cart</a>
        </div>
        <div class="col-4">
            <a class="btn btn-dark thumbnail" asp-controller="cart"
               asp-action="addtocart" asp-route-id="2" asp-route-currentPage="@currentPage">Add to cart</a>
        </div>
        <div class="col-4">
            <a class="btn btn-dark thumbnail" asp-controller="cart"
               asp-action="addtocart" asp-route-id="3">Add to cart</a>
        </div>
    </div>
</div>


<div id='container'>
    <ejs-dialog id='dialog' isModal="true" width="760px" height="390px" overlayClick="onOverlayClick"
                target="#container" visible="false">
        <e-content-template>
            @*NEED TO CHANGE THE ID TO THE ACTUAL ID FROM DATABASE.*@
            @await Component.InvokeAsync("MovieDetails", new{ id = 1})
        </e-content-template>
    </ejs-dialog>
</div>

<script>
    window.onload = function () {
        document.getElementById('details').onclick = function () {
            var dialog = document.getElementById("dialog").ej2_instances[0];
            dialog.show();
        }
    }
    function onOverlayClick() {
        var dialog = document.getElementById("dialog").ej2_instances[0];
        dialog.hide();
    }
</script>

